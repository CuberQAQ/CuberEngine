{"version":3,"sources":["utils.ts"],"names":[],"mappings":"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","file":"../CuberEngine/scripts/utils.js","sourcesContent":["// Utils for Minecraft Bedrock Edition\r\n// Author: CuberQAQ <https://github.com/CuberQAQ>\r\n// Liscence: GPLv3 https://www.gnu.org/licenses/gpl-3.0.html\r\n// Based on GameTest Framework (https://learn.microsoft.com/zh-cn/minecraft/creator/scriptapi/)\r\n// Version: 1.0.0\r\n\r\n// Copyright CuberQAQ. All rights reserved.\r\n\r\nimport {\r\n  Entity,\r\n  GameMode,\r\n  Player,\r\n  ScoreboardIdentityType,\r\n  ScoreboardObjective,\r\n  World,\r\n  system,\r\n  world,\r\n} from \"@minecraft/server\";\r\nimport { data, permissionList } from \"./Data\";\r\n\r\nconst adminList = [\"Justin Ai06\", \"CuberQAQ\", \"ChristianBez787\", \"jf2542\"];\r\n\r\nfunction tellErrorMessage(sender: string, message: string) {\r\n  world\r\n    .getDimension(\"overworld\")\r\n    .runCommandAsync(\r\n      'tellraw @a {\"rawtext\":[{\"text\":\"[§e' +\r\n        sender.replace(/\"/g, '\\\\\"') +\r\n        \"§r] §c\" +\r\n        message.replace(/\"/g, '\\\\\"') +\r\n        '\"}]} '\r\n    );\r\n  // world.broadcastClientMessage(sender, message);\r\n}\r\nfunction tellSuccessMessage(sender: string, message: string) {\r\n  world\r\n    .getDimension(\"overworld\")\r\n    .runCommandAsync(\r\n      'tellraw @a {\"rawtext\":[{\"text\":\"[§e' +\r\n        sender.replace(/\"/g, '\\\\\"') +\r\n        \"§r] §a\" +\r\n        message.replace(/\"/g, '\\\\\"') +\r\n        '\"}]} '\r\n    );\r\n  // world.broadcastClientMessage(sender, message);\r\n}\r\nfunction anaylseError(module_name: string, error: any, append?: string) {\r\n  if (error instanceof Error) {\r\n    tellErrorMessage(\r\n      module_name,\r\n      \"Catch an Error in Module [\" +\r\n        module_name +\r\n        \"]:\\nError Name: \" +\r\n        error.name +\r\n        \"\\nError Message: \" +\r\n        error.message +\r\n        \"\\nError Stack: \" +\r\n        error.stack +\r\n        (append ? \"\\nAppend Message: \" + append : \"\")\r\n    );\r\n  } else if (typeof error == \"string\") {\r\n    tellErrorMessage(\r\n      module_name,\r\n      \"Catch an Error in Module [\" +\r\n        module_name +\r\n        \"]\\nError String: \" +\r\n        error +\r\n        (append ? \"\\nAppend Message: \" + append : \"\")\r\n    );\r\n  } else {\r\n    tellErrorMessage(\r\n      module_name,\r\n      \"Catch an Error in Module [\" +\r\n        module_name +\r\n        \"]\\nError Type: \" +\r\n        typeof error +\r\n        \"\\nJSON stringify: \" +\r\n        ((e) => {\r\n          // try to Transform error from Any to Json String\r\n          try {\r\n            return JSON.stringify(e);\r\n          } catch (e) {\r\n            return \"Transform Failed\";\r\n          }\r\n        })(error) +\r\n        (append ? \"\\nAppend Message: \" + append : \"\")\r\n    );\r\n  }\r\n  throw error;\r\n}\r\nfunction tellMessage(sender: string, message: string) {\r\n  try {\r\n    world\r\n      .getDimension(\"overworld\")\r\n      .runCommandAsync(\r\n        'tellraw @a {\"rawtext\":[{\"text\":\"[§e' +\r\n          sender.replace(/\"/g, '\\\\\"') +\r\n          \"§r] \" +\r\n          message.replace(/\"/g, '\\\\\"') +\r\n          '\"}]} '\r\n      );\r\n    // world.broadcastClientMessage(sender, message);\r\n  } catch (e) {\r\n    anaylseError(\"UTILS\", e, \"In tellMessage\");\r\n  }\r\n}\r\nfunction isAdmin(nameTag: string) {\r\n  return adminList.find((item) => item == nameTag) ? true : false;\r\n}\r\nfunction test(func: Function, module_name?: string, append?: string) {\r\n  try {\r\n    func();\r\n  } catch (e) {\r\n    anaylseError(module_name ?? \"UTILS_TEST\", e, \"(Test Function)\" + (append ?? \"\"));\r\n  }\r\n}\r\n// 妈的，新版本没法在event里调用敏感api 可以套层壳\r\nfunction delayBox(func: Function, delay_tick: number = 0) {\r\n  if (delay_tick == 0) {\r\n    return new Promise<undefined>((resolve: Function, reject: Function) => {\r\n      system.run(async () => {\r\n        try {\r\n          await func();\r\n          resolve();\r\n        } catch (e) {\r\n          anaylseError(\"DelayBox\", e, \"Error When Run Function in DelayBox\");\r\n          reject();\r\n        }\r\n      });\r\n    });\r\n  } else {\r\n    return new Promise<undefined>((resolve: Function, reject: Function) => {\r\n      system.runTimeout(async () => {\r\n        try {\r\n          await func();\r\n          resolve();\r\n        } catch (e) {\r\n          anaylseError(\"DelayBox\", e, \"Error When Run Function in DelayBox\");\r\n          reject();\r\n        }\r\n      }, delay_tick);\r\n    });\r\n  }\r\n}\r\nfunction singlePermissionTest(player_name: string, permission_key: string): boolean {\r\n  // tellMessage(\"Permission\", \"Permission Test:[\" + permission_key + \"]\");\r\n  if (!permissionList) {\r\n    tellErrorMessage(\"Permission\", \"Permission list Undefined!\");\r\n    return false;\r\n  }\r\n  if (!permissionList[permission_key]) {\r\n    // tellErrorMessage(\"Permission\", \"Unknown Permission Key: \" + permission_key);\r\n    return false;\r\n  }\r\n  let length = permissionList[permission_key].length;\r\n  for (let i = 0; i < length; ++i) {\r\n    if (permissionList[permission_key][i] == player_name) {\r\n      // tellSuccessMessage(\"Permission\", \"Have This Permission\");\r\n      return true;\r\n    }\r\n  }\r\n  // tellErrorMessage(\"Permission\", \"No This Permission\");\r\n  return false;\r\n}\r\nfunction permissionStrTest(player_name: string, permission_str: string): boolean {\r\n  // tellMessage(\"Permission\", \"Permission JSON:\" + JSON.stringify(permissionList));\r\n  // tellMessage(\"Permission\", \"@\" + player_name + \"PermissionStr Test:\" + permission_str);\r\n\r\n  let permissionKeyList = permission_str.split(\",\");\r\n  let length = permissionKeyList.length;\r\n  for (let i = 0; i < length; ++i) {\r\n    if (singlePermissionTest(player_name, permissionKeyList[i].trim())) {\r\n      // tellSuccessMessage(\"Permission\", \"OK\");\r\n      return true;\r\n    }\r\n  }\r\n  // tellErrorMessage(\"Permission\", \"Fail\");\r\n  return false;\r\n}\r\nfunction getPlayerScore(objective: ScoreboardObjective, target?: Player | Entity | string): number | undefined {\r\n  if (!target || !objective) return undefined;\r\n  let participants = objective.getParticipants();\r\n  if (!participants) return undefined;\r\n  if (typeof target == \"string\") {\r\n    if (!data.players[target]) return undefined;\r\n    let targetId = data.players[target].score_id;\r\n    let participant = participants.find((item) => {\r\n      if (item.type == ScoreboardIdentityType.Player) {\r\n        return item.id == targetId;\r\n      } else {\r\n        return false;\r\n      }\r\n    });\r\n    if (participant == undefined) return undefined;\r\n    else return objective.getScore(participant);\r\n  } else if (target instanceof Player) {\r\n    let participant = participants.find((item) => {\r\n      if (item.type == ScoreboardIdentityType.Player) {\r\n        try {\r\n          // tellMessage(\"getScore\", \"item.id=\" + item.id);\r\n          // tellMessage(\"getScore\", \"target.id=\" + target.id);\r\n          return item.id == target.scoreboardIdentity?.id;\r\n        } catch (e) {\r\n          anaylseError(\"getScore\", e, \"item:\" + item.displayName);\r\n        }\r\n      }\r\n      return false;\r\n    });\r\n    if (participant == undefined) return undefined;\r\n    else return objective.getScore(participant);\r\n  }\r\n}\r\nasync function getGamemode(player: Player): Promise<GameMode | undefined> {\r\n  try {\r\n    (await player.runCommandAsync(\"testfor @s[m=1]\")).successCount;\r\n    //tellMessage(\"Gamemode\", \"@\" + player.name + \" creative\");\r\n    return GameMode.creative;\r\n  } catch (error) {}\r\n  try {\r\n    (await player.runCommandAsync(\"testfor @s[m=spectator]\")).successCount;\r\n    //tellMessage(\"Gamemode\", \"@\" + player.name + \" spectator\");\r\n    return GameMode.spectator;\r\n  } catch (error) {}\r\n  try {\r\n    (await player.runCommandAsync(\"testfor @s[m=0]\")).successCount;\r\n    //tellMessage(\"Gamemode\", \"@\" + player.name + \" survival\");\r\n    return GameMode.survival;\r\n  } catch (error) {}\r\n  try {\r\n    (await player.runCommandAsync(\"testfor @s[m=2]\")).successCount;\r\n    //tellMessage(\"Gamemode\", \"@\" + player.name + \" adventure\");\r\n    return GameMode.adventure;\r\n  } catch (error) {}\r\n  //tellMessage(\"Gamemode\", \"@\" + player.name + \" unknown\");\r\n}\r\n/**\r\n * 返回日期数字\r\n * @returns Date Number YYYYMMDD\r\n */\r\nfunction getDate(utc?: number): number {\r\n  let date = utc ? new Date(utc) : new Date();\r\n  date.setTime(date.getTime() + 28800000);\r\n  return date.getFullYear() * 10000 + (date.getMonth() + 1) * 100 + date.getDate();\r\n}\r\n/**\r\n * 延迟执行函数\r\n * @param {function} func 延迟执行函数\r\n * @param {number} ticktime game-tick\r\n * @returns {Promise}\r\n * @example 异步模块，使用promise封装，基于tick事件\r\n */\r\nconst setTimeout = function (func: Function, ticktime: number = 0): void {\r\n  system.runTimeout(func(), ticktime);\r\n};\r\nexport {\r\n  tellErrorMessage,\r\n  tellSuccessMessage,\r\n  tellMessage,\r\n  isAdmin,\r\n  anaylseError,\r\n  test,\r\n  getPlayerScore,\r\n  getDate,\r\n  getGamemode,\r\n  setTimeout,\r\n  delayBox,\r\n  permissionStrTest,\r\n};\r\n"],"sourceRoot":"../../../scripts/"}