{"version":3,"sources":["Data.ts"],"names":[],"mappings":"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","file":"../CuberEngine/scripts/Data.js","sourcesContent":["// Data for Minecraft Bedrock Edition\r\n// Author: CuberQAQ <https://github.com/CuberQAQ>\r\n// Liscence: GPLv3 https://www.gnu.org/licenses/gpl-3.0.html\r\n// Based on GameTest Framework (https://learn.microsoft.com/zh-cn/minecraft/creator/scriptapi/)\r\n// Version: 3.0.0\r\n\r\n// Copyright CuberQAQ. All rights reserved.\r\n\r\nimport { http, HttpClient, HttpRequest, HttpResponse, HttpHeader, HttpRequestMethod } from \"@minecraft/server-net\";\r\nimport { anaylseError, tellErrorMessage, tellMessage, tellSuccessMessage } from \"./utils\";\r\nimport { system, world } from \"@minecraft/server\";\r\n\r\nconst moduleName = \"Data\";\r\nconst moduleVersion = \"0.1.1\";\r\nvar data: any = null;\r\nvar permissionList: PermissionListType | null = null;\r\nvar backupInfo: any = {};\r\n\r\ninterface PermissionListType {\r\n  [key: string]: Array<string>;\r\n}\r\n\r\ninterface BackupInfoType {\r\n  path: string;\r\n  append: string;\r\n  creater: string;\r\n  auto: boolean;\r\n}\r\n\r\nfunction initData() {\r\n  reloadData();\r\n  reloadPermission();\r\n  reloadBackupInfo();\r\n  return { moduleName, moduleVersion };\r\n}\r\nfunction reloadData() {\r\n  console.log(\"[CuberEngine] Reload Data...\");\r\n  let req = new HttpRequest(\"http://localhost:25641/data.json\");\r\n  req.setMethod(HttpRequestMethod.Get);\r\n  req.addHeader(\"reload\", \"true\");\r\n  req.setTimeout(60);\r\n  http.request(req).then(\r\n    (res) => {\r\n      if (res.status == 200) {\r\n        console.log(\"[CuberEngine] HTTP Get Data Succeeded.\");\r\n        // tellSuccessMessage(moduleName, \"HTTP Get Data Succeeded. [\" + res.status + \"]\");\r\n        data = JSON.parse(decodeURIComponent(res.body));\r\n      } else {\r\n        console.error(\"[CuberEngine] HTTP Get Data Failed.\");\r\n        tellErrorMessage(moduleName, \"HTTP Get Data Failed. [\" + res.status + \"]\");\r\n      }\r\n    },\r\n    (res) => {\r\n      console.error(\"[CuberEngine] HTTP Get Data Failed.\");\r\n      tellErrorMessage(moduleName, \"HTTP GET Data Failed. [NULL] \" + res);\r\n    }\r\n  );\r\n}\r\nfunction reloadPermission() {\r\n  console.log(\"[CuberEngine] Reload Permission List...\");\r\n  let req = new HttpRequest(\"http://localhost:25641/permission.json\");\r\n  req.setMethod(HttpRequestMethod.Get);\r\n  req.addHeader(\"reload\", \"true\");\r\n  req.setTimeout(60);\r\n  http.request(req).then(\r\n    (res) => {\r\n      if (res.status == 200) {\r\n        console.log(\"[CuberEngine] HTTP Get Permission List Succeeded.\");\r\n        // tellSuccessMessage(moduleName, \"HTTP Get Data Succeeded. [\" + res.status + \"]\");\r\n        permissionList = JSON.parse(decodeURIComponent(res.body));\r\n      } else {\r\n        console.error(\"[CuberEngine] HTTP Get Permission List Failed.\");\r\n        tellErrorMessage(moduleName, \"HTTP Get Permission List Failed. [\" + res.status + \"]\");\r\n      }\r\n    },\r\n    (res) => {\r\n      console.error(\"[CuberEngine] HTTP Get Permission List Failed.\");\r\n      tellErrorMessage(moduleName, \"HTTP Get Permission List Failed. [NULL] \" + res);\r\n    }\r\n  );\r\n}\r\nfunction reloadBackupInfo() {\r\n  console.log(\"[CuberEngine] Reload Backup Info...\");\r\n  let req = new HttpRequest(\"http://localhost:25641/backup/info.json\");\r\n  req.setMethod(HttpRequestMethod.Get);\r\n  //req.addHeader(\"reload\", \"true\");\r\n  req.setTimeout(60);\r\n  http.request(req).then(\r\n    (res) => {\r\n      if (res.status == 200) {\r\n        console.log(\"[CuberEngine] HTTP Get Data Succeeded.\");\r\n        // tellSuccessMessage(moduleName, \"HTTP Get Data Succeeded. [\" + res.status + \"]\");\r\n        backupInfo = JSON.parse(decodeURIComponent(res.body));\r\n      } else {\r\n        console.error(\"[CuberEngine] HTTP Get BackupInfo Failed.\");\r\n        tellErrorMessage(moduleName, \"HTTP Get BackupInfo Failed. [\" + res.status + \"]\");\r\n      }\r\n    },\r\n    (res) => {\r\n      console.error(\"[CuberEngine] HTTP Get BackupInfo Failed.\");\r\n      tellErrorMessage(moduleName, \"HTTP GET BackupInfo Failed. [NULL] \" + res);\r\n    }\r\n  );\r\n}\r\nfunction backup(info: BackupInfoType, append?: string) {\r\n  let require = new HttpRequest(\"http://127.0.0.1:25641/backup\");\r\n  require.setMethod(HttpRequestMethod.Post);\r\n  require.addHeader(\"key\", \"31415926535897932384626\");\r\n  if (append) require.addHeader(\"append\", append);\r\n  require.addHeader(\"Content-Type\", \"application/json; charset=utf-8\");\r\n  //require.addHeader(\"cookie\", encodeURIComponent(JSON.stringify(data)));\r\n  require.setBody(JSON.stringify(info));\r\n  // require.setBody(encodeURIComponent(JSON.stringify(data)));\r\n  require.setTimeout(60);\r\n  return http.request(require).then(\r\n    // success\r\n    (response) => {\r\n      if (response.status == 200) {\r\n        return [true, response.body];\r\n        // tellSuccessMessage(moduleName, \"HTTP Save Data Success [\" + response.status + \"]\");\r\n      } else tellErrorMessage(moduleName, \"HTTP Create Backup Failed [\" + response.status + \"]\");\r\n      return [false, response.body];\r\n    },\r\n    // fail\r\n    (response) => {\r\n      tellErrorMessage(moduleName, \"HTTP Create Backup Failed [PROMIST_FAILURE]\");\r\n      return [false, \"外部备份接口连接失败\"];\r\n    }\r\n  );\r\n}\r\nfunction sudo(command: string, append?: string) {\r\n  system.run(() => {\r\n    var require = new HttpRequest(\"http://127.0.0.1:25641/sudo\");\r\n    require.setMethod(HttpRequestMethod.Post);\r\n    require.addHeader(\"key\", \"31415926535897932384626\");\r\n    if (append) require.addHeader(\"append\", append);\r\n    require.addHeader(\"Content-Type\", \"application/json; charset=utf-8\");\r\n    //require.addHeader(\"cookie\", encodeURIComponent(JSON.stringify(data)));\r\n    require.setBody(JSON.stringify({ command }));\r\n    // require.setBody(encodeURIComponent(JSON.stringify(data)));\r\n    require.setTimeout(60);\r\n    // require.setBody(encodeURIComponent(JSON.stringify(data)));\r\n    return http.request(require).then(\r\n      // success\r\n      (response) => {\r\n        if (response.status == 200) {\r\n          return [true, response.body];\r\n          // tellSuccessMessage(moduleName, \"HTTP Save Data Success [\" + response.status + \"]\");\r\n        } else tellErrorMessage(moduleName, \"HTTP Remote Command Failed [\" + response.status + \"]\");\r\n        return [false, response.body];\r\n      },\r\n      // fail\r\n      (response) => {\r\n        tellErrorMessage(moduleName, \"HTTP Remote Command Failed [PROMIST_FAILURE]\");\r\n        return [false, \"外部接口连接失败\"];\r\n      }\r\n    );\r\n  });\r\n}\r\nfunction restore(path: string, append: string) {\r\n  let require = new HttpRequest(\"http://127.0.0.1:25641/restore\");\r\n  require.setMethod(HttpRequestMethod.Get);\r\n  require.addHeader(\"key\", \"31415926535897932384626\");\r\n  require.addHeader(\"path\", path);\r\n  require.addHeader(\"reload\", \"true\");\r\n  if (append) require.addHeader(\"append\", append);\r\n  require.addHeader(\"Content-Type\", \"application/json; charset=utf-8\");\r\n  require.setTimeout(10);\r\n  return http.request(require).then(\r\n    // success\r\n    (response) => {\r\n      if (response.status == 200) {\r\n        return [true, response.body];\r\n        // tellSuccessMessage(moduleName, \"HTTP Save Data Success [\" + response.status + \"]\");\r\n      } else tellErrorMessage(moduleName, \"HTTP Save Data Failed [\" + response.status + \"]\");\r\n      return [false, response.body];\r\n    },\r\n    // fail\r\n    (response) => {\r\n      tellErrorMessage(moduleName, \"HTTP Save Data Failed [PROMIST_FAILURE]\");\r\n      return [false, \"外部备份接口连接失败\"];\r\n    }\r\n  );\r\n}\r\n\r\nfunction delBackup(path: string, append: string) {\r\n  let require = new HttpRequest(\"http://127.0.0.1:25641/delBackup\");\r\n  require.setMethod(HttpRequestMethod.Get);\r\n  require.addHeader(\"key\", \"31415926535897932384626\");\r\n  require.addHeader(\"path\", path);\r\n  require.addHeader(\"reload\", \"true\");\r\n  if (append) require.addHeader(\"append\", append);\r\n  require.addHeader(\"Content-Type\", \"application/json; charset=utf-8\");\r\n  require.setTimeout(30);\r\n  return http.request(require).then(\r\n    // success\r\n    (response) => {\r\n      if (response.status == 200) {\r\n        return [true, response.body];\r\n        // tellSuccessMessage(moduleName, \"HTTP Save Data Success [\" + response.status + \"]\");\r\n      } else tellErrorMessage(moduleName, \"HTTP Delete Backup Failed [\" + response.status + \"]\");\r\n      return [false, response.body];\r\n    },\r\n    // fail\r\n    (response) => {\r\n      tellErrorMessage(moduleName, \"HTTP Delete Backup Failed [PROMIST_FAILURE]\");\r\n      return [false, \"外部备份接口连接失败\"];\r\n    }\r\n  );\r\n}\r\nasync function saveData(append?: string) {\r\n  let require = new HttpRequest(\"http://127.0.0.1:25641/data.json\");\r\n  require.setMethod(HttpRequestMethod.Post);\r\n  require.addHeader(\"upgrade\", \"save\");\r\n  if (append) require.addHeader(\"append\", append);\r\n  require.addHeader(\"Content-Type\", \"application/json; charset=utf-8\");\r\n  //require.addHeader(\"cookie\", encodeURIComponent(JSON.stringify(data)));\r\n  require.setBody(JSON.stringify(data));\r\n  // require.setBody(encodeURIComponent(JSON.stringify(data)));\r\n  require.setTimeout(60);\r\n  let response = await http.request(require);\r\n  if (response.status != 200) {\r\n    tellErrorMessage(moduleName, \"HTTP Save Data Failed [\" + response.status + \"]\");\r\n  }\r\n}\r\nasync function savePermission(append?: string) {\r\n  let require = new HttpRequest(\"http://127.0.0.1:25641/permission.json\");\r\n  require.setMethod(HttpRequestMethod.Post);\r\n  require.addHeader(\"upgrade\", \"save\");\r\n  if (append) require.addHeader(\"append\", append);\r\n  require.addHeader(\"Content-Type\", \"application/json; charset=utf-8\");\r\n  //require.addHeader(\"cookie\", encodeURIComponent(JSON.stringify(data)));\r\n  require.setBody(JSON.stringify(permissionList));\r\n  // require.setBody(encodeURIComponent(JSON.stringify(data)));\r\n  require.setTimeout(60);\r\n  let response = await http.request(require);\r\n  if (response.status != 200) {\r\n    tellErrorMessage(moduleName, \"HTTP Save Permission List Failed [\" + response.status + \"]\");\r\n  }\r\n}\r\nasync function saveBackupInfo(append?: string) {\r\n  let require = new HttpRequest(\"http://127.0.0.1:25641/backup/info.json\");\r\n  require.setMethod(HttpRequestMethod.Post);\r\n  require.addHeader(\"upgrade\", \"save\");\r\n  if (append) require.addHeader(\"append\", append);\r\n  require.addHeader(\"Content-Type\", \"application/json; charset=utf-8\");\r\n  //require.addHeader(\"cookie\", encodeURIComponent(JSON.stringify(data)));\r\n  require.setBody(JSON.stringify(backupInfo));\r\n  // require.setBody(encodeURIComponent(JSON.stringify(data)));\r\n  require.setTimeout(20);\r\n  let response = await http.request(require);\r\n  if (response.status != 200) {\r\n    tellErrorMessage(moduleName, \"HTTP Save BackupInfo Failed [\" + response.status + \"]\");\r\n  }\r\n}\r\n\r\nexport {\r\n  initData,\r\n  data,\r\n  permissionList,\r\n  saveData,\r\n  savePermission,\r\n  reloadPermission,\r\n  reloadData,\r\n  backupInfo,\r\n  saveBackupInfo,\r\n  reloadBackupInfo,\r\n  restore,\r\n  backup,\r\n  delBackup,\r\n  sudo,\r\n};\r\n"],"sourceRoot":"../../../scripts/"}