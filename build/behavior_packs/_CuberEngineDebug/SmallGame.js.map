{"version":3,"sources":["SmallGame.ts"],"names":[],"mappings":"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","file":"../CuberEngine/scripts/SmallGame.js","sourcesContent":["// SmallGame for Minecraft Bedrock Edition\r\n// Author: CuberQAQ <https://github.com/CuberQAQ>\r\n// Liscence: GPLv3 https://www.gnu.org/licenses/gpl-3.0.html\r\n// Based on GameTest Framework (https://learn.microsoft.com/zh-cn/minecraft/creator/scriptapi/)\r\n// Version: 3.0.0\r\n\r\n// Copyright CuberQAQ. All rights reserved.\r\nimport { Player, world, system, EntityHealthComponent } from \"@minecraft/server\";\r\nimport { showSnowMenu } from \"./CuberSnow\";\r\nimport { tellMessage } from \"./utils\";\r\nconst moduleName = \"SmallGame\";\r\nconst moduleVersion = \"0.1.0\";\r\nfunction initSmallGame() {\r\n  world.afterEvents.blockBreak.subscribe((e) => {\r\n    if (e.player.hasTag(\"zq_l\") || e.player.hasTag(\"zq_h\")) {\r\n      if (e.brokenBlockPermutation.type.id == \"minecraft:leaves\") {\r\n        e.block.setPermutation(e.brokenBlockPermutation.clone());\r\n        showSnowMenu(e.player, \"zq\");\r\n      } else if (e.brokenBlockPermutation.type.id != \"minecraft:white_wool\") {\r\n        e.player.runCommandAsync(\r\n          'tellraw @s {\"rawtext\":[{\"text\":\"§c不允许破坏此方块:' + e.brokenBlockPermutation.type.id + '\"}]}'\r\n        );\r\n        e.block.setType(e.brokenBlockPermutation.type);\r\n      }\r\n    }\r\n  });\r\n  world.afterEvents.entityHurt.subscribe((e) => {\r\n    // tellMessage(moduleName, \"entityHurt e.cause = \" + e.cause);\r\n    // tellMessage(moduleName, \"entityHurt e.damage = \" + e.damage);\r\n    // tellMessage(moduleName, \"entityHurt e.damagingEntity.nameTag = \" + e.damagingEntity.nameTag);\r\n    // tellMessage(moduleName, \"entityHurt e.hurtEntity.nameTag = \" + e.hurtEntity.nameTag);\r\n    // tellMessage(moduleName, \"entityHurt e.projectile.nameTag = \" + e.projectile.typeId);\r\n    if (e.hurtEntity.hasTag(\"msss\")) {\r\n      {\r\n        // tellMessage(\r\n        //   moduleName,\r\n        //   \"玩家当前血量: \" + (e.hurtEntity.getComponent(\"minecraft:health\") as EntityHealthComponent)?.current\r\n        // );\r\n        // tellMessage(moduleName, \"伤害扣血: \" + e.damage);\r\n        if ((e.hurtEntity.getComponent(\"minecraft:health\") as EntityHealthComponent)?.currentValue <= 0) {\r\n          tellMessage(\"§c密室杀手\", \"§e§l\" + e.hurtEntity.nameTag + \"§r 死了!\");\r\n        } else if (\r\n          e.damageSource.damagingEntity?.hasTag(\"msss\") &&\r\n          e.damageSource.damagingProjectile?.typeId == \"minecraft:arrow\"\r\n        ) {\r\n          e.hurtEntity.runCommandAsync(\"kill\");\r\n          // tellMessage(\r\n          //   \"密室杀手\",\r\n          //   \"§e§l\" + e.hurtEntity.nameTag + \" §r被 §e§l\" + e.damagingEntity.nameTag + \" §r一箭§c§l射杀了！\"\r\n          // );\r\n          // tellMessage(\"§c密室杀手\", \"§e§l\" + e.hurtEntity.nameTag + \"§r 死了!\");\r\n        } else if (\r\n          e.damageSource.damagingEntity?.hasTag(\"msss\") &&\r\n          e.damageSource.damagingProjectile?.typeId == \"minecraft:thrown_trident\"\r\n        ) {\r\n          e.hurtEntity.runCommandAsync(\"kill\");\r\n          // tellMessage(\r\n          //   \"密室杀手\",\r\n          //   \"§e§l\" + e.hurtEntity.nameTag + \" §r被 §e§l\" + e.damagingEntity.nameTag + \" §r用三叉戟§c§l穿透了！\"\r\n          // );\r\n          // tellMessage(\"§c密室杀手\", \"§e§l\" + e.hurtEntity.nameTag + \"§r 死了!\");\r\n        }\r\n      }\r\n    } else if (e.hurtEntity.hasTag(\"msss2\")) {\r\n      {\r\n        if ((e.hurtEntity.getComponent(\"minecraft:health\") as EntityHealthComponent)?.currentValue <= 0) {\r\n          tellMessage(\"§c密室杀手\", \"§e§l\" + e.hurtEntity.nameTag + \"§r 死了!\");\r\n        } else if (\r\n          e.damageSource.damagingEntity?.hasTag(\"msss2_zt\") &&\r\n          e.damageSource.damagingProjectile?.typeId == \"minecraft:arrow\" &&\r\n          e.hurtEntity.hasTag(\"msss2_ss\")\r\n        ) {\r\n          e.hurtEntity.runCommandAsync(\"kill\");\r\n        } else if (\r\n          e.damageSource.damagingEntity?.hasTag(\"msss2_ss\") &&\r\n          e.damageSource.damagingProjectile?.typeId == \"minecraft:thrown_trident\" &&\r\n          e.hurtEntity.hasTag(\"msss2_zt\")\r\n        ) {\r\n          e.hurtEntity.runCommandAsync(\"kill\");\r\n        }\r\n      }\r\n    }\r\n  });\r\n  return { moduleName, moduleVersion };\r\n}\r\n\r\nexport { initSmallGame };\r\n"],"sourceRoot":"../../../scripts/"}